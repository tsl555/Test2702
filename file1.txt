and return it again
The new implementation by #1
with fix
and fix
change in master